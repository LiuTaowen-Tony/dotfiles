#!/bin/bash

ENC="$HOME/dotfiles/env.gpg"
OUT="$HOME/dotfiles/bin/.env"

if ! command -v gpg >/dev/null 2>&1; then
  echo "gpg not found. Install it first (macOS: brew install gnupg; Linux: install gnupg)." >&2
  exit 1
fi

mkdir -p "$(dirname "$OUT")"
umask 077

[ -f "$OUT" ] || gpg --decrypt "$ENC" > "$OUT"

chmod 600 "$OUT"

while read -r line ; do
    export "$line" 2> /dev/null
done < $HOME/dotfiles/bin/.env

command python3 $HOME/dotfiles/bin/call_gemini.py "$@"

